<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SGFHR6J5SJ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-SGFHR6J5SJ');
    </script>

    <%= display_meta_tags(default_meta_tags) %>

    <%# <%= javascript_include_tag "main", "data-turbo-track": "reload", defer: true %>
    <%# <%= stylesheet_link_tag 'main', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%# <%= stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload" %>
    <%= vite_client_tag %>
    <%= vite_javascript_tag 'application' %>

    <script>
      function css_browser_selector(u){var ua=u.toLowerCase(),is=function(t){return ua.indexOf(t)>-1},g='gecko',w='webkit',s='safari',o='opera',m='mobile',h=document.documentElement,b=[(!(/opera|webtv/i.test(ua))&&/msie\s(\d)/.test(ua))?('ie ie'+RegExp.$1):is('firefox/2')?g+' ff2':is('firefox/3.5')?g+' ff3 ff3_5':is('firefox/3.6')?g+' ff3 ff3_6':is('firefox/3')?g+' ff3':is('gecko/')?g:is('opera')?o+(/version\/(\d+)/.test(ua)?' '+o+RegExp.$1:(/opera(\s|\/)(\d+)/.test(ua)?' '+o+RegExp.$2:'')):is('konqueror')?'konqueror':is('blackberry')?m+' blackberry':is('android')?m+' android':is('chrome')?w+' chrome':is('iron')?w+' iron':is('applewebkit/')?w+' '+s+(/version\/(\d+)/.test(ua)?' '+s+RegExp.$1:''):is('mozilla/')?g:'',is('j2me')?m+' j2me':is('iphone')?m+' iphone':is('ipod')?m+' ipod':is('ipad')?m+' ipad':is('mac')?'mac':is('darwin')?'mac':is('webtv')?'webtv':is('win')?'win'+(is('windows nt 6.0')?' vista':''):is('freebsd')?'freebsd':(is('x11')||is('linux'))?'linux':'','js']; c = b.join(' '); h.className += ' '+c; return c;}; css_browser_selector(navigator.userAgent);
    </script>

    <style>
      @font-face {
        font-family: 'FirefoxCantarell';
        font-weight: normal;
        font-style: normal;
        src: url("<%= asset_path 'cantarell_firefox.ttf' %>");
        font-display: swap;
      }
      @font-face {
        font-family: 'ChromeCantarell';
        font-style: normal;
        font-weight: normal;
        src: url(<%= asset_path 'cantarell_chrome.woff2' %>) format('woff2');
        font-display: swap;
      }
    </style>

    <meta name="current-user-stared-posts" content="<%= current_user ? current_user.stars.where(starable_type: "Post").pluck(:starable_id).join(" ") : []  %>">
  </head>

  <body>
    <div id="toolbar-trix" class="hidden">
      <%= render(TrixToolbar.new) %>
    </div>
    <div class="min-h-screen">
      <%= render(Layout::NavBar::Component.new(current_user: current_user)) %>
      <div class="container max-w-5xl mx-auto mb-8 px-4">
        <div id="flash-messages">
          <% if alert %>
            <%= render(Layout::Toast.new(alert, type: :error)) %>
          <% end %>
          <% if notice %>
            <%= render(Layout::Toast.new(notice, type: :info)) %>
          <% end %>
        </div>

        <%= yield %>
      </div>

      <%= yield :containerless %>
    </div>
    <footer class="mt-20 bg-beaver-900 border-t border-beaver-800 text-white px-4">
      <div class="container max-w-5xl mx-auto py-6">
        <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
          <a href="https://github.com/reklis/grey-hack-repo" class="link flex items-center gap-2 hover:text-primary transition-colors">
            <%= octicon "mark-github", height: 20, class: "fill-current" %>
            <span>Contribute on GitHub</span>
          </a>
          <a href="https://element.fm" class="flex items-center gap-2 text-sm text-gray-400 hover:text-white transition-colors">
            <span>Sponsored by</span>
            <span class="font-bold text-white">ELEMENT.FM</span>
          </a>
        </div>
      </div>
    </footer>
  </body>
</html>
